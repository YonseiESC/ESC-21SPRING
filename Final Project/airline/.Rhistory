# Retrieving 179.96
rm(list=ls())
iq = c(1, 1, 0, 0)
status = c(1, 0, 1, 0)
satisfy = c(117, 54, 29, 31)
n = c(117+47, 54+87, 29+78, 31+262)
unsat = n-satisfy
P = satisfy / n
# logLs
loglik <- function(yes, no, pr) (yes*log(pr) + no*log(1-pr))
logLs = 0
for (i in 1:length(satisfy)) {
logLs = logLs + loglik(satisfy[i], unsat[i], P[i])
}
logLs
# logL0
p = sum(satisfy) / sum(n)
logL0 = 0
for (i in 1:length(satisfy)) {
logL0 = logL0 + loglik(satisfy[i], unsat[i], p)
}
logL0
2*(logLs-logL0)
response = matrix(c(satisfy, unsat), ncol=2)
# fit = glm(response ~ iq + status + iq:status, family=binomial(link="logit"))
fit = glm(response ~ iq + status + iq:status, family=binomial)
summary(fit)
sum(satisfy)
sum((obs-ex)^2/ex)
Piq = 305/705; Psta = 271/705; Psat = 231/705
# c(111, 110, 101, 100, 011, 010, 001, 000)
obs = c(117, 47, 54, 87, 29, 78, 31, 262)
ex = 705 * c(Piq*Psta*Psat, Piq*Psta*(1-Psat), Piq*(1-Psta)*Psat, Piq*(1-Psta)*(1-Psat),
(1-Piq)*Psta*Psat, (1-Piq)*Psta*(1-Psat), (1-Piq)*(1-Psta)*Psat, (1-Piq)*(1-Psta)*(1-Psat))
sum((obs-ex)^2/ex)
ex
Piq = 305/705; Psta = 271/705; Psat = 231/705
# c(111, 110, 101, 100, 011, 010, 001, 000)
obs = c(117, 47, 54, 87, 29, 78, 31, 262)
# ex = 705 * c(Piq*Psta*Psat, Piq*Psta*(1-Psat), Piq*(1-Psta)*Psat, Piq*(1-Psta)*(1-Psat),
#              (1-Piq)*Psta*Psat, (1-Piq)*Psta*(1-Psat), (1-Piq)*(1-Psta)*Psat, (1-Piq)*(1-Psta)*(1-Psat))
ex = 705^2 * c(305*271*231, 305*271*474, 305*434*231, 305*434, 474,
400*271*231, 400*271*474, 400*434*231, 400*434, 474)
ex
sum((obs-ex)^2/ex)
Piq = 305/705; Psta = 271/705; Psat = 231/705
# c(111, 110, 101, 100, 011, 010, 001, 000)
obs = c(117, 47, 54, 87, 29, 78, 31, 262)
# ex = 705 * c(Piq*Psta*Psat, Piq*Psta*(1-Psat), Piq*(1-Psta)*Psat, Piq*(1-Psta)*(1-Psat),
#              (1-Piq)*Psta*Psat, (1-Piq)*Psta*(1-Psat), (1-Piq)*(1-Psta)*Psat, (1-Piq)*(1-Psta)*(1-Psat))
ex = 705^2 * c(305*271*231, 305*271*474, 305*434*231, 305*434*474,
400*271*231, 400*271*474, 400*434*231, 400*434*474)
ex
sum((obs-ex)^2/ex)
Piq = 305/705; Psta = 271/705; Psat = 231/705
# c(111, 110, 101, 100, 011, 010, 001, 000)
obs = c(117, 47, 54, 87, 29, 78, 31, 262)
# ex = 705 * c(Piq*Psta*Psat, Piq*Psta*(1-Psat), Piq*(1-Psta)*Psat, Piq*(1-Psta)*(1-Psat),
#              (1-Piq)*Psta*Psat, (1-Piq)*Psta*(1-Psat), (1-Piq)*(1-Psta)*Psat, (1-Piq)*(1-Psta)*(1-Psat))
ex = 1/705^2 * c(305*271*231, 305*271*474, 305*434*231, 305*434*474,
400*271*231, 400*271*474, 400*434*231, 400*434*474)
ex
sum((obs-ex)^2/ex)
rm(list=ls())
n11 = 48; n12 = 16; n21 = 20; n22 = 40
n1 = n11 + n12; n2 = n21 + n22
after = matrix(c(n11, n12, n21, n22), ncol=2, byrow=T)
dimnames(after) = list(X=c("Remedy", "Placebo"), Better=c("Yes", "No"))
after
p1 = n11 / (n11 + n12)
p2 = n21 / (n21 + n22)
print(paste("p1-p2: ", p1-p2))
se = sqrt(p1*(1-p1)/n1 + p2*(1-p2)/n2)
print(paste("se: ", se))
# 95% C.I.
(p1-p2) + se*c(-1.96, 1.96)
1/31
logRR = log(p1/p2)
print(paste("logRR: ", logRR))
seRR = sqrt((1-p1)/(n1*p1) + (1-p2)/(n2*p2))
print(paste("seRR: ", seRR))
# 95% C.I. for logRR
logRR + seRR*c(-1.96, 1.96)
# 95% C.I. for RR
exp(logRR + seRR*c(-1.96, 1.96))
OR = n11*n22/(n12*n21)
OR - (p1/(1-p1))/(p2/(1-p2)) < 1.e-08
print(paste("OR: ", OR))
logOR = log(OR)
print(paste("logOR: ", logOR))
aseOR = sqrt(1/n11 + 1/n12 + 1/n21 + 1/n22)
print(paste("aseOR: ", aseOR))
# 95% C.I. for logOR
logOR + aseOR*c(-1.96, 1.96)
# 95% C.I. for OR
exp(logOR + aseOR*c(-1.96, 1.96))
log(c(p1/(1-p1), p2/(1-p2)))
1.0986123+0.6931472
OR = n11*n22/(n12*n21)
OR - (p1/(1-p1))/(p2/(1-p2)) < 1.e-08
print(paste("OR: ", OR))
logOR = log(OR)
print(paste("logOR: ", logOR))
aseOR = sqrt(1/n11 + 1/n12 + 1/n21 + 1/n22)
print(paste("aseOR: ", aseOR))
# 95% C.I. for logOR
logOR + aseOR*c(-1.96, 1.96)
# 95% C.I. for OR
exp(logOR + aseOR*c(-1.96, 1.96))
p1
p2
# setup
rm(list=ls())
X = c(0, 2, 10, 20, 40, 60)
Y1 = c(10, 50, 500, 450, 300, 50)
Y0 = c(50, 100, 600, 450, 150, 10)
n = Y1 + Y0
P = Y1/n
N = sum(n)
# A : logLs
loglik <- function(yes, no, pr) (yes*log(pr) + no*log(1-pr))
logLs = 0
for (i in 1:length(X)) {
logLs = logLs + loglik(Y1[i], Y0[i], P[i])
}
logLs
# B : logL
logL = 0
for (i in 1:length(X)) {
p = exp(-0.6082 + 0.0334*X[i]) / (1+exp(-0.6082 + 0.0334*X[i]))
logL = logL + loglik(Y1[i], Y0[i], p)
}
logL
# C : logL0
logL0 = 0
for (i in 1:length(X)) {
logL0 = logL0 + loglik(Y1[i], Y0[i], 0.5)
}
logL0
sum(Y1)
# s.e.(a)
sqrt(1/(N*p*(1-p)))
# s.e.(a)
sqrt(1/(N*0.5*(1-0.5)))
0.03405/0.00323
pchisq((0.03405/0.00323)^2, 1)
# Wald
0.03405/0.00323
pchisq((0.03405/0.00323)^2, 1)
# LRT
D = 2*(logL - logL0)
pchisq(D, 1)
# setup
rm(list=ls())
X = c(0, 2, 10, 20, 40, 60)
Y1 = c(7, 55, 489, 475, 293, 38)
Y0 = c(61, 129, 570, 431, 154, 12)
n = Y1 + Y0
P = Y1/n
N = sum(n)
# A : logLs
loglik <- function(yes, no, pr) (yes*log(pr) + no*log(1-pr))
logLs = 0
for (i in 1:length(X)) {
logLs = logLs + loglik(Y1[i], Y0[i], P[i])
}
logLs
# B : logL
logL = 0
for (i in 1:length(X)) {
p = exp(-0.6082 + 0.0334*X[i]) / (1+exp(-0.6082 + 0.0334*X[i]))
logL = logL + loglik(Y1[i], Y0[i], p)
}
logL
# C : logL0
logL0 = 0
for (i in 1:length(X)) {
logL0 = logL0 + loglik(Y1[i], Y0[i], 0.5)
}
logL0
exp(0.03405 + 1.96*c(-0.00323, 0.00323))
rm(list=ls())
n11 = 48; n12 = 16; n21 = 20; n22 = 40
n1 = n11 + n12; n2 = n21 + n22
after = matrix(c(n11, n12, n21, n22), ncol=2, byrow=T)
dimnames(after) = list(X=c("Remedy", "Placebo"), Better=c("Yes", "No"))
after
p1 = n11 / (n11 + n12)
p2 = n21 / (n21 + n22)
print(paste("p1-p2: ", p1-p2))
se = sqrt(p1*(1-p1)/n1 + p2*(1-p2)/n2)
print(paste("se: ", se))
# 95% C.I.
(p1-p2) + se*c(-1.96, 1.96)
logRR = log(p1/p2)
print(paste("logRR: ", logRR))
seRR = sqrt((1-p1)/(n1*p1) + (1-p2)/(n2*p2))
print(paste("seRR: ", seRR))
# 95% C.I. for logRR
logRR + seRR*c(-1.96, 1.96)
# 95% C.I. for RR
exp(logRR + seRR*c(-1.96, 1.96))
OR = n11*n22/(n12*n21)
OR - (p1/(1-p1))/(p2/(1-p2)) < 1.e-08
print(paste("OR: ", OR))
logOR = log(OR)
print(paste("logOR: ", logOR))
aseOR = sqrt(1/n11 + 1/n12 + 1/n21 + 1/n22)
print(paste("aseOR: ", aseOR))
# 95% C.I. for logOR
logOR + aseOR*c(-1.96, 1.96)
# 95% C.I. for OR
exp(logOR + aseOR*c(-1.96, 1.96))
log(c(p1/(1-p1), p2/(1-p2)))
1.0986123+0.6931472
# setup
rm(list=ls())
X = c(0, 2, 10, 20, 40, 60)
Y1 = c(10, 50, 500, 450, 300, 50)
Y0 = c(50, 100, 600, 450, 150, 10)
n = Y1 + Y0
P = Y1/n
N = sum(n)
# A : logLs
loglik <- function(yes, no, pr) (yes*log(pr) + no*log(1-pr))
logLs = 0
for (i in 1:length(X)) {
logLs = logLs + loglik(Y1[i], Y0[i], P[i])
}
logLs
# B : logL
logL = 0
for (i in 1:length(X)) {
p = exp(-0.6082 + 0.0334*X[i]) / (1+exp(-0.6082 + 0.0334*X[i]))
logL = logL + loglik(Y1[i], Y0[i], p)
}
logL
# C : logL0
logL0 = 0
for (i in 1:length(X)) {
logL0 = logL0 + loglik(Y1[i], Y0[i], 0.5)
}
logL0
# s.e.(a)
sqrt(1/(N*0.5*(1-0.5)))
# Wald
0.03405/0.00323
pchisq((0.03405/0.00323)^2, 1)
# LRT
D = 2*(logL - logL0)
pchisq(D, 1)
exp(0.03405 + 1.96*c(-0.00323, 0.00323))
pchisq(D, 6-2)
D = 2*(logLs - logL)
D
pchisq(D, 6-2)
rm(list=ls())
p11 = 74 / (74+245)
p10 = 4 / (4+164)
p01 = 57 / (57+682)
p00 = 34 / (34+577)
log(c(p11, p10, p01, p00)/c(1-p11, 1-p10, 1-p01, 1-p00))
A = matrix(c(1, 1, 1, 1,
1, 1, 0, 0,
1, 0, 1, 0,
1, 0, 0, 0), byrow=TRUE, nrow=4)
solve(A) %*% log(c(p11, p10, p01, p00)/c(1-p11, 1-p10, 1-p01, 1-p00))
sqrt(1/74+1/245+1/4+1/164+1/57+1/682+1/34+1/577)
p1 = 131 / (131+927)
p0 = 38 / (38+1259)
log(p1/(1-p1))
log(p0/(1-p0))
log(p1/(1-p1)) - log(p0/(1-p0))
# s.e.(beta)
sqrt(1/131 + 1/38 + 1/927 + 1/1259)
p1 = 131 / (131+927)
p0 = 38 / (38+741)
log(p1/(1-p1))
log(p0/(1-p0))
log(p1/(1-p1)) - log(p0/(1-p0))
# s.e.(beta)
sqrt(1/131 + 1/38 + 1/927 + 1/741)
p1 = 131 / (131+927)
p0 = 38 / (38+741)
log(p1/(1-p1))
log(p0/(1-p0))
log(p1/(1-p1)) - log(p0/(1-p0))
# s.e.(beta)
sqrt(1/131 + 1/38 + 1/927 + 1/741)
loglik <- function(yes, no, pr) (yes*log(pr) + no*log(1-pr))
loglik(131, 927, p1) + loglik(38, 741, p0)
pnorm(0.9395/0.1923)
pchisq((0.9395/0.1923)^2, 1)
pnorm(2.1688/0.5690)
D = 2*(-523.73+534.05)
pchisq(D, 1)
126/(126+390)
se = sqrt(p1*(1-p1)/161 + p2*(1-p2)/161)
p1 = 126/161; p2 = 39/161
se = sqrt(p1*(1-p1)/161 + p2*(1-p2)/161)
(p1-p2)/se
p1 = 126/161; p2 = 39/161
se = sqrt(p1*(1-p1)/161 + p2*(1-p2)/161)
(p1-p2)/se
rm(list=ls())
n11 = 784; n10 = 236; n01 = 311; n00 = 66
n1 = n11 + n10; n0 = n01 + n00
gun = matrix(c(n11, n10, n01, n00), ncol=2, byrow=T)
dimnames(gun) = list(Gun=c("Agree", "Disagree"), Death=c("Agree", "Disagree"))
gun
p1 = n11 / (n11 + n10)
p0 = n01 / (n01 + n00)
print(paste("p1-p0: ", p1-p0))
se = sqrt(p1*(1-p1)/n1 + p0*(1-p0)/n2)
p1 = n11 / (n11 + n10)
p0 = n01 / (n01 + n00)
print(paste("p1-p0: ", p1-p0))
se = sqrt(p1*(1-p1)/n1 + p0*(1-p0)/n0)
print(paste("se: ", se))
# 95% C.I.
(p1-p2) + se*c(-1.96, 1.96)
p1 = n11 / (n11 + n10)
p0 = n01 / (n01 + n00)
print(paste("p1-p0: ", p1-p0))
se = sqrt(p1*(1-p1)/n1 + p0*(1-p0)/n0)
print(paste("se: ", se))
# 95% C.I.
(p1-p0) + se*c(-1.96, 1.96)
p1 = n11 / (n11 + n10)
p0 = n01 / (n01 + n00)
print(paste("p1-p0: ", p1-p0))
se = sqrt(p1*(1-p1)/n1 + p0*(1-p0)/n0)
print(paste("se: ", se))
# z statistic
z = (p1-p0)/se
z
pnorm(z)
p1 = n11 / (n11 + n10)
p0 = n01 / (n01 + n00)
print(paste("p1-p0: ", p1-p0))
se = sqrt(p1*(1-p1)/n1 + p0*(1-p0)/n0)
print(paste("se: ", se))
# z statistic
z = (p1-p0)/se
z
pnorm(z)*2
p1 = n11 / (n11 + n01)
p0 = n10 / (n10 + n00)
print(paste("p1-p0: ", p1-p0))
se = sqrt(p1*(1-p1)/n1 + p0*(1-p0)/n0)
print(paste("se: ", se))
# z statistic
z = (p1-p0)/se
z
pnorm(z)*2
p1 = n11 / (n11 + n01)
p0 = n10 / (n10 + n00)
n1 = n11 + n01; n0 = n10 + n00
print(paste("p1-p0: ", p1-p0))
se = sqrt(p1*(1-p1)/n1 + p0*(1-p0)/n0)
print(paste("se: ", se))
# z statistic
z = (p1-p0)/se
z
pnorm(z)*2
p1 = n11 / (n11 + n10)
p0 = n01 / (n01 + n00)
n1 = n11 + n10; n0 = n01 + n00
logRR = log(p1/p0)
print(paste("logRR: ", logRR))
seRR = sqrt((1-p1)/(n1*p1) + (1-p0)/(n0*p0))
print(paste("seRR: ", seRR))
# 95% C.I. for logRR
logRR + seRR*c(-1.96, 1.96)
# 95% C.I. for RR
exp(logRR + seRR*c(-1.96, 1.96))
n1
n1
n2
n1
n0
N = n1+n0
N
1095 / (1095+302)
log(p/(1-p))
p = 1095 / (1095+302)
log(p/(1-p))
p = 1095 / (1095+302)
log(p/(1-p))
sqrt(1/(N*p*(1-p)))
log(784/236)
log(311/66)
log(784/236)-log(311/66)
sqrt(5.1503/1396)
6*log(2/3) + 3*log(1/3)
9*log(1/2)
pchisq(2*(6*log(2/3) + 3*log(1/3) - 9*log(1/2)), 1)
# Beijing
126+100+35+61
# Shanghai
908+688+497+807
40/55 - 120/150
40/55 - 120/150
p1 = 40/55
p2 = 120/150
se = sqrt(p1*(1-p1)/44 + p2*(1-p2)/150)
(p1-p2)/se
40/55 - 120/150
p1 = 40/55
p2 = 120/150
se = sqrt(p1*(1-p1)/44 + p2*(1-p2)/150)
(p1-p2)/se
pnorm((p1-p2)/se)
40/55 - 120/150
p1 = 40/55
p2 = 120/150
se = sqrt(p1*(1-p1)/44 + p2*(1-p2)/150)
se
(p1-p2)/se
pnorm((p1-p2)/se)
log(p1)
log(p2)
log(p1) - log(p2)
sqrt((1-p1)/(55*p1) + (1-p2)/(150*p2))
log(40/15)
log(4)
log(40/15)-log(4)
sqrt(1/40 + 1/15 + 1/120 + 1/30)
log(75/10)
log(45/60)
log(3/8)
log(45/60) - log(75/10)
(log(3/8) - log(75/10))/2
(log(3/8) - log(75/10))/2 - (log(45/60) - log(75/10))
-1.4979+2.3046
x = c(0, 1, 2)
x^2
x = c(0, 1, 2)
f = 2.0149 + 0.8067*x + 0.8047*x^2
p = exp(f)/(1+exp(f))
75*log(p[1])+10*log(1-p[1])+45*log(p[2])+60*log(1-p[2])+30*log(p[3]) + 80*log(1-p[3])
300*log(1/2)
(45+600-(105+220)/2)/(sqrt((105+440)-(105+220)^2/300)*sqrt(150-(150)^2/300))
rm(list=ls())
p11 = 40 / (40+47)
p10 = 54 / (54+87)
p01 = 29 / (29+78)
p00 = 31 / (31+262)
log(c(p11, p10, p01, p00)/c(1-p11, 1-p10, 1-p01, 1-p00))
A = matrix(c(1, 1, 1, 1,
1, 0, 1, 0,
1, 1, 0, 0,
1, 0, 0, 0), byrow=TRUE, nrow=4)
solve(A) %*% log(c(p11, p10, p01, p00)/c(1-p11, 1-p10, 1-p01, 1-p00))
log(31/262)
log(29/78) - log(31/262)
se = sqrt(1/40 + 1/47 + 1/54 + 1/87 +1/29 + 1/78 + 1/31 + 1/262)
se
-0.8293/se
se = sqrt(1/40 + 1/47 + 1/54 + 1/87 +1/29 + 1/78 + 1/31 + 1/262)
z = -0.8293/se
pnorm(z)
pchisq(z^2, 1)
log(40/47)-log(54/87)
log(29/78) - log(31/262)
0.3157/2 + 2*1.1449/3
x = c(0, 1, 2)
f = 2.0149 + 0.8067*x + 0.8047*x^2
p = exp(f)/(1+exp(f))
75*log(p[1])+10*log(1-p[1])+45*log(p[2])+60*log(1-p[2])+30*log(p[3]) + 80*log(1-p[3])
p
45+60 - (105+220)*150/300
sqrt((105+440)-325^2/300)
sqrt(150-150^2/300)
```{r}
57.5/13.889/8.6602
sqrt(299)*0.4780
exp(30)
log(30)
pnorm((67.2-78.4)/sqrt(31.36))
(67.2-78.4)/sqrt(31.36)
(90-78.4)/sqrt(31.36)
pnorm(90-78.4)/sqrt(31.36), lower.tail=FALSE)
pnorm((90-78.4)/sqrt(31.36), lower.tail=FALSE)
pnorm((100-78.4)/sqrt(31.36), lower.tail=FALSE)
exp(-3)*3^3/3!
(exp(-3)*3^3/factorial(3)) / (0.3*exp(-3)*3^3/factorial(3) + 0.7*exp(-5)*5^3/factorial(3))
(exp(-3)*3^3/factorial(3)*0.3) / (0.3*exp(-3)*3^3/factorial(3) + 0.7*exp(-5)*5^3/factorial(3))
setwd("~/Downloads")
read.table("communities.data")
crime <- read.table("communities.data")
View(crime)
crime <- read.table("communities.data", sep = ",")
crime.names <- read.names("communities.names")
library(readr)
crimedata <- read_csv("~/Desktop/crimedata.csv")
View(crimedata)
setwd("~/Desktop")
crime <- read.csv("crimedata.csv")
View(crime)
library(readr)
Auction_master_train_en <- read_csv("final project/auction/Auction_master_en/Auction_master_train_en.csv")
View(Auction_master_train_en)
setwd("~/Desktop/final project/airline")
bigAirDS <- RxXdfData("AirOnTime7Pct.xdf")
install.packages("RevoScaleR")
install.packages(RevoScaleR)
library(RevoScaleR)
library(readr)
airOT201201 <- read_csv("~/Downloads/airOT201201.csv")
View(airOT201201)
View(airOT201201)
